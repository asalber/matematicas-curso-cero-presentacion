\begin{tikzpicture}[scale=1]
    \def\a{1.5}
    \def\b{6.5}
    \def\c{4.5}
    \def\L{1} % width of interval
    
    \pgfmathsetmacro{\Va}{sin(\a r-1)+4} \pgfmathresult
    \pgfmathsetmacro{\Vb}{sin(\b r-1)+4} \pgfmathresult
    \pgfmathsetmacro{\Vc}{sin(\c r-1)+4} \pgfmathresult
    
    \draw[-Latex, myblack] (-0.5,0) -- (9,0) coordinate (x axis) node[below] {$x$};
    \draw[-Latex, myblack] (0,-0.5) -- (0,6) coordinate (y axis) node[left] {$y$};
    \foreach \f in {1.5,2.5,...,6.5} {\pgfmathparse{sin(\f r-1)+4} \pgfmathresult
    \draw[fill=myblue!40, opacity = 0.5] (\f-\L/2,\pgfmathresult |- x axis) -- (\f-\L/2,\pgfmathresult) -- (\f+\L/2,\pgfmathresult) -- (\f+\L/2,\pgfmathresult |- x axis) -- cycle;}
    \node[myblack, anchor = east] at (\a+0.3-\L/2,-10pt) {$a=x_0$};
    \node[myblack, anchor = west] at (\b-0.3+\L/2,-10pt) {$x_n=b$};
    %\draw[blue] (\c-\L/2,0) -- (\c-\L/2,\Vc) -- (\c+\L/2,\Vc) -- (\c+\L/2,0);
    \draw[dashed, mygray] (\c,0) -- (\c,\Vc/2) -- (0,\Vc/2) node[left, myred] {$\frac{1}{2}f(\bar x_i)$};
    \draw[dashed, mygray] (\c,\Vc/2) -- (\c,\Vc) -- (0,\Vc) node[left, myblack] {$f(\bar x_i)$};
    \node[myblack] at (\a+5*\L/2,-10pt) {$x_{i-1}$};
    \node[myblack] at (\a+7*\L/2,-10pt) {$x_i$};
    \node[myred] at (\a+6*\L/2,-10pt) {$\bar x_i$};
    \draw[myblue, line width = 1pt, smooth, samples=100, domain=1:7] plot(\x,{sin(\x r-1)+4});
    \node[myblue, anchor = west] at (7, 5) {$f(x)$};
    \filldraw[myred] (\c,\Vc/2) circle (2pt);
\end{tikzpicture}